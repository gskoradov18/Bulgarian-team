<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tri</title>
    <link rel="icon" href="https://cdn4.iconfinder.com/data/icons/marine-3/64/C_Sea_Sunset-512.png" type="image/gif" sizes="16x16"><!--Adding an icon to the site-->
    <link rel="stylesheet" href="Style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Mobile first(responsive) from Bootstrap 4-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"><!--for css from Bootstrap 4-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script><!--JQuery library from Bootstrap 4-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script><!--must include for Bootstrap 4-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script><!--must include for Bootstrap 4-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js"></script>
    <script src="JS/Navigation_bar.js"></script>
    <script src="JS/Google_Map.js"></script>
</head>
<body>
<script src="JS/nav.js"></script>
<div class="vertical-nav bg-white" id="sidebar">

</div>
<script>
    $(document).ready(function () {
        checkCookie();
        // setInterval(retrieveData, 4000);
    });
</script>
<div class="page-content p-5" id="content">
    <button id="sidebarCollapse" type="button" class="btn btn-light bg-white rounded-pill shadow-sm px-4 mb-4" onclick="Nav()"><i class="fa fa-bars mr-2"></i><small class="text-uppercase font-weight-bold">Toggle</small></button>


    <div class="container">
        <div class="row bg-dark rounded">
            <div class="col-sm-4">
                <button class="btn btn-outline-light">&nbsp;&nbsp;&nbsp;Posoki &nbsp;&nbsp;&nbsp;</button>
            </div>
            <div class="col-sm-4">
                <button class="btn btn-outline-light">&nbsp;&nbsp;&nbsp;Posoki &nbsp;&nbsp;&nbsp;</button>
            </div>
            <div class="col-sm-4">
                <button class="btn btn-outline-light">&nbsp;&nbsp;&nbsp;Posoki &nbsp;&nbsp;&nbsp;</button>
            </div>
        </div>
        <div class="row bg-light rounded mb-5">
                <div class="col-sm-12">
                    <canvas class="text-uppercase font-weight-bold" id="radarChart"></canvas>
                </div>
        </div>
    </div>
    <div class="container">
        <div class="row text-center text-justify">
            <div class="col-4">

            </div>
            <div class="col-4">
                <button id="MapButtonNot"  class="btn btn-dark" onclick="ChangePosition(0)">This is not my location</button>
                <button id="MapButton" class="btn btn-dark" style="visibility: hidden" onclick="checkCookie()">This is my location</button>
            </div>
            <div class="col-4">

            </div>
        </div>
    </div>
    <div id="map-container" class="container">
        <div class="row mb-5">
            <div class="col-12">
                <div class="map-responsive">
                    <div id="map"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row bg-light rounded mb-5">
            <div class="col-sm-12">
                <canvas class="text-uppercase font-weight-bold" id="Wind speed-chart"></canvas>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row bg-light rounded mb-5">
            <div class="col-sm-12">
                <canvas class="text-uppercase font-weight-bold" id="Temperature-chart"></canvas>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row bg-light rounded mb-5">
            <div class="col-sm-12">
                <canvas class="text-uppercase font-weight-bold" id="Humidity-chart"></canvas>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row bg-light rounded mb-5">
            <div class="col-sm-12">
                <canvas class="text-uppercase font-weight-bold" id="Barometric pressure-chart"></canvas>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row bg-light rounded mb-5">
            <div class="col-sm-12">
                <canvas class="text-uppercase font-weight-bold" id="Rain fall-chart"></canvas>
            </div>
        </div>
    </div>
</div>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBfJBulfextFpj8Uk8p65pp_x1FR-zI2wI&callback=initMap"
        async defer></script>

<script>
    var windespeed=0
    function retrieveData(){
        console.log("retrieveData");
        var i=0;
        $.getJSON( "http://blynk-cloud.com/UWTOAploXLDZ7e8fqY81foQMNUdhkJlt/get/V5", function( data ) {

            var ArduinoInfo=data[0].split(",");
            windespeed[i] =  ArduinoInfo[1];
            i++;
        });
    }
    setInterval(retrieveData, 4000);
    var today = new Date();
    var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
    // function fn60sec() {
    // }
    // fn60sec();
    // setInterval(fn60sec, 5*1000);

    function addMinutes(seconds) {

        var DateNow=new Date(today.getTime() + seconds*100 + 7200000);
        var StringDate=JSON.stringify(DateNow);
        var Time=StringDate.split(" ");
        Time=Time[0].split("T");
        Time=Time[1].split(".");
        Time=Time[0].split(":");
        var TimeForCharts=Time[0]+":"+Time[1]+":"+Time[2];
        return TimeForCharts;
    }
    var i =0;
    new Chart(document.getElementById("Wind speed-chart").getContext('2d'), {
        type: 'line',
        data: {
            labels: [addMinutes(0) ,addMinutes(5),addMinutes(10),addMinutes(15),addMinutes(20),addMinutes(25),addMinutes(30),addMinutes(35),addMinutes(40),addMinutes(45)],
            datasets: [{
                data: [windespeed[i],2,3,6,1,7,8,9,2,5],
                label: "Arduino station",
                borderColor: "#3e95cd",
                fill: false
            }
            ]
        },
        options: {
            title: {
                display: true,
                text: 'Max Wind speed m/s'
            }
        }
    });
    new Chart(document.getElementById("Temperature-chart").getContext('2d'), {
        type: 'line',
        data: {
            labels: [addMinutes(0) ,addMinutes(5),addMinutes(10),addMinutes(15),addMinutes(20),addMinutes(25),addMinutes(30),addMinutes(35),addMinutes(40),addMinutes(45)],
            datasets: [{
                data: [5,2,3,6,1,7,8,9,2,5],
                label: "Arduino station",
                borderColor: "#8e2ecd",
                fill: false
            }
            ]
        },
        options: {
            title: {
                display: true,
                text: 'Temperatur C'
            }
        }
    });
    new Chart(document.getElementById("Humidity-chart").getContext('2d'), {
        type: 'line',
        data: {
            labels: [addMinutes(0) ,addMinutes(5),addMinutes(10),addMinutes(15),addMinutes(20),addMinutes(25),addMinutes(30),addMinutes(35),addMinutes(40),addMinutes(45)],
            datasets: [{
                data: [5,2,3,6,1,7,8,9,2,5],
                label: "Arduino station",
                borderColor: "#66cd57",
                fill: false
            }
            ]
        },
        options: {
            title: {
                display: true,
                text: 'Humidity %'
            }
        }
    });
    new Chart(document.getElementById("Barometric pressure-chart").getContext('2d'), {
        type: 'line',
        data: {
            labels: [addMinutes(0) ,addMinutes(5),addMinutes(10),addMinutes(15),addMinutes(20),addMinutes(25),addMinutes(30),addMinutes(35),addMinutes(40),addMinutes(45)],
            datasets: [{
                data: [5,2,3,6,1,7,8,9,2,5],
                label: "Arduino station",
                borderColor: "#cdc02b",
                fill: false
            }
            ]
        },
        options: {
            title: {
                display: true,
                text: 'Barometric pressure hPa'
            }
        }
    });
    new Chart(document.getElementById("Rain fall-chart" ).getContext('2d'), {
        type: 'line',
        data: {
            labels: [addMinutes(0) ,addMinutes(5),addMinutes(10),addMinutes(15),addMinutes(20),addMinutes(25),addMinutes(30),addMinutes(35),addMinutes(40),addMinutes(45)],
            datasets: [{
                data: [5,2,3,6,1,7,8,9,2,5],
                label: "Arduino station",
                borderColor: "#cd172a",
                fill: false
            }
            ]
        },
        options: {
            title: {
                display: true,
                text: 'Rain fall mm'
            }
        }
    });
    var ctxR = document.getElementById("radarChart").getContext('2d');
    var myRadarChart = new Chart(ctxR, {
        type: 'radar',
        data: {
            labels: ["  N", "NNE", "NE", "ENE", "E", "ESE", "SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"],
            datasets: [{
                label: "neshto",
                data: [65, 59, 90, 81, 56, 55, 40],
                backgroundColor: [
                    'rgba(105, 0, 132, .2)',
                ],
                borderColor: [
                    'rgba(200, 99, 132, .7)',
                ],
                borderWidth: 2
            },
                {
                    label: "neshto 2",
                    data: [28, 48, 40, 19, 96, 27, 100],
                    backgroundColor: [
                        'rgba(0, 250, 220, .2)',
                    ],
                    borderColor: [
                        'rgba(0, 213, 132, .7)',
                    ],
                    borderWidth: 2
                }
            ]
        },
        options: {
            responsive: true
        }
    });
    $( "#sidebar" ).html( navigation );
</script>
<!-- <script>
    $( "#sidebar" ).html( navigation );
    document.body.style.backgroundImage = "url(https://wallpaperaccess.com/full/1638770.jpg)";// background image
</script> -->

</body>
</html>